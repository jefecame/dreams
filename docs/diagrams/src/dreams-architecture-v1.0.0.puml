@startuml Dreams Sales System - Architecture Diagram

!theme blueprint

' Configuration
skinparam backgroundColor transparent
skinparam shadowing false
skinparam linetype ortho
skinparam componentStyle rectangle

' Modern color scheme
skinparam component {
    BackgroundColor #E8F4FD
    BorderColor #2E86AB
    FontColor #1F4E79
}

skinparam package {
    BackgroundColor #F8F9FA
    BorderColor #6C757D
    FontColor #212529
}

skinparam interface {
    BackgroundColor #28A745
    BorderColor #1E7E34
    FontColor White
}

title Dreams Sales System - System Architecture\n<size:14><color:gray>Layered Architecture with Clean Code Principles</color></size>

' === EXTERNAL ACTORS ===
actor "ðŸŒ Web Users" as WebUsers #LightBlue
actor "ðŸ“± Mobile Users" as MobileUsers #LightGreen  
actor "ðŸª POS Systems" as POSSystems #Orange
actor "ðŸ‘¨â€ðŸ’¼ Administrators" as Admins #LightCoral

' === PRESENTATION LAYER ===
package "ðŸ–¥ï¸ Presentation Layer" #LightBlue {
    
    component "ðŸŒ Web Application" as WebApp {
        component "React Frontend" as ReactApp
        component "Redux Store" as ReduxStore
        component "UI Components" as UIComponents
    }
    
    component "ðŸ“± Mobile Application" as MobileApp {
        component "Flutter/React Native" as MobileFramework
        component "Mobile State Management" as MobileState
    }
    
    component "ðŸ–¨ï¸ POS Interface" as POSInterface {
        component "Desktop Client" as DesktopClient
        component "Touch Interface" as TouchUI
    }
    
    component "âš™ï¸ Admin Dashboard" as AdminDashboard {
        component "Management Console" as ManagementConsole
        component "Analytics Dashboard" as Analytics
        component "System Monitor" as SystemMonitor
    }
}

' === API LAYER ===
package "ðŸ”Œ API Gateway & Services" #LightYellow {
    
    interface "ðŸšª API Gateway" as APIGateway #LightGreen
    
    component "ðŸ” Authentication Service" as AuthService
    component "ðŸ›¡ï¸ Authorization Service" as AuthzService
    component "ðŸ“Š Rate Limiting" as RateLimit
    component "ðŸ“ API Logging" as APILogging
}

' === APPLICATION LAYER ===
package "ðŸ—ï¸ Application Layer" #LightGreen {
    
    package "ðŸ›’ Sales Domain" #PowderBlue {
        component "Sales Controller" as SalesController
        component "Cart Controller" as CartController
        component "Order Controller" as OrderController
        component "Invoice Controller" as InvoiceController
    }
    
    package "ðŸ“¦ Product Domain" #MistyRose {
        component "Product Controller" as ProductController
        component "Inventory Controller" as InventoryController
        component "Category Controller" as CategoryController
    }
    
    package "ðŸ‘¥ Customer Domain" #LightGoldenRodYellow {
        component "Customer Controller" as CustomerController
        component "Profile Controller" as ProfileController
    }
    
    package "ðŸ“Š Analytics Domain" #Lavender {
        component "Reports Controller" as ReportsController
        component "Analytics Controller" as AnalyticsController
    }
}

' === BUSINESS LAYER ===
package "ðŸ’¼ Business Logic Layer" #Orange {
    
    package "ðŸŽ¯ Core Services" #LightSalmon {
        component "Sales Service" as SalesService
        component "Product Service" as ProductService
        component "Customer Service" as CustomerService
        component "Inventory Service" as InventoryService
        component "Payment Service" as PaymentService
        component "Notification Service" as NotificationService
    }
    
    package "ðŸ”§ Domain Services" #PeachPuff {
        component "Tax Calculator" as TaxCalculator
        component "Discount Engine" as DiscountEngine
        component "Stock Manager" as StockManager
        component "Price Calculator" as PriceCalculator
    }
    
    package "âš¡ Event Handlers" #Moccasin {
        component "Sale Completed Handler" as SaleHandler
        component "Stock Updated Handler" as StockHandler
        component "Customer Created Handler" as CustomerHandler
    }
}

' === INFRASTRUCTURE LAYER ===
package "ðŸ­ Infrastructure Layer" #LightCoral {
    
    package "ðŸ’¾ Data Access" #RosyBrown {
        component "Customer Repository" as CustomerRepo
        component "Product Repository" as ProductRepo
        component "Sales Repository" as SalesRepo
        component "Inventory Repository" as InventoryRepo
        component "User Repository" as UserRepo
    }
    
    package "ðŸ”Œ External Integrations" #LightPink {
        component "Payment Gateway" as PaymentGateway
        component "Email Service" as EmailService
        component "SMS Service" as SMSService
        component "Print Service" as PrintService
        component "Tax API" as TaxAPI
    }
    
    package "ðŸ—„ï¸ Data Storage" #Silver {
        database "ðŸ—ƒï¸ PostgreSQL\nMain Database" as MainDB
        database "ðŸ“Š Redis\nCache & Sessions" as CacheDB
        database "ðŸ“ˆ InfluxDB\nMetrics & Analytics" as MetricsDB
        database "ðŸ“ File Storage\nDocuments & Images" as FileStorage
    }
}

' === CROSS-CUTTING CONCERNS ===
package "ðŸ›¡ï¸ Cross-Cutting Concerns" #LightGray {
    component "ðŸ“ Logging Service" as LoggingService
    component "ðŸ“Š Monitoring & Metrics" as MonitoringService
    component "ðŸ” Health Checks" as HealthService
    component "âš¡ Event Bus" as EventBus
    component "ðŸ”§ Configuration Manager" as ConfigManager
    component "ðŸ§ª Feature Flags" as FeatureFlags
}

' === EXTERNAL SYSTEMS ===
package "ðŸŒ External Systems" #LightSteelBlue {
    component "ðŸ’³ Payment Processors" as PaymentProcessors
    component "ðŸ“§ Email Providers" as EmailProviders  
    component "ðŸ“± SMS Gateways" as SMSGateways
    component "ðŸ›ï¸ Tax Authorities" as TaxAuthorities
    component "ðŸ“Š Analytics Platforms" as AnalyticsPlatforms
}

' === CONNECTIONS ===

' User to Presentation
WebUsers --> WebApp
MobileUsers --> MobileApp
POSSystems --> POSInterface
Admins --> AdminDashboard

' Presentation to API Gateway
WebApp --> APIGateway
MobileApp --> APIGateway
POSInterface --> APIGateway
AdminDashboard --> APIGateway

' API Gateway to Application Layer
APIGateway --> SalesController
APIGateway --> ProductController
APIGateway --> CustomerController
APIGateway --> ReportsController

' API Gateway Components
APIGateway ..> AuthService
APIGateway ..> AuthzService
APIGateway ..> RateLimit
APIGateway ..> APILogging

' Application to Business Layer
SalesController --> SalesService
CartController --> SalesService
ProductController --> ProductService
CustomerController --> CustomerService
InventoryController --> InventoryService

' Business Layer Internal
SalesService --> TaxCalculator
SalesService --> DiscountEngine
SalesService --> PaymentService
ProductService --> StockManager
SalesService --> NotificationService

' Business to Infrastructure
SalesService --> SalesRepo
ProductService --> ProductRepo
CustomerService --> CustomerRepo
InventoryService --> InventoryRepo
PaymentService --> PaymentGateway
NotificationService --> EmailService

' Repositories to Databases
CustomerRepo --> MainDB
ProductRepo --> MainDB
SalesRepo --> MainDB
InventoryRepo --> MainDB
UserRepo --> MainDB

' Cache connections
SalesService --> CacheDB
ProductService --> CacheDB

' Analytics connections
AnalyticsController --> MetricsDB
MonitoringService --> MetricsDB

' External integrations
PaymentGateway --> PaymentProcessors
EmailService --> EmailProviders
SMSService --> SMSGateways
TaxCalculator --> TaxAuthorities
AnalyticsController --> AnalyticsPlatforms

' Cross-cutting concerns
SalesService ..> LoggingService
ProductService ..> LoggingService
CustomerService ..> LoggingService
SalesService ..> EventBus
ProductService ..> EventBus

' Event Handlers
EventBus --> SaleHandler
EventBus --> StockHandler
EventBus --> CustomerHandler

' === NOTES ===
note top of APIGateway
    **Single Entry Point**
    â€¢ Request routing
    â€¢ Authentication/Authorization  
    â€¢ Rate limiting
    â€¢ Request/Response logging
    â€¢ API versioning
end note

note right of SalesService
    **Core Business Logic**
    â€¢ Domain rules enforcement
    â€¢ Transaction management
    â€¢ Business workflows
    â€¢ Event publishing
end note

note bottom of MainDB
    **ACID Transactions**
    â€¢ Customer data
    â€¢ Product catalog
    â€¢ Sales records
    â€¢ Inventory tracking
    â€¢ User accounts
end note

note left of EventBus
    **Async Processing**
    â€¢ Decoupled communication
    â€¢ Event-driven architecture
    â€¢ Scalable workflows
    â€¢ Audit trail
end note

@enduml
